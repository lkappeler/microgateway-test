/********************************************************* {COPYRIGHT-TOP} ***
 * Licensed Materials - Property of IBM
 * 5725-Z22, 5725-Z63, 5725-U33, 5725-Z63
 *
 * (C) Copyright IBM Corporation 2016, 2017
 *
 * All Rights Reserved.
 * US Government Users Restricted Rights - Use, duplication or disclosure
 * restricted by GSA ADP Schedule Contract with IBM Corp.
 ********************************************************** {COPYRIGHT-END} **/
// Node module: apiconnect-cli-logger

var Stream = require('stream');
require('colors');
// Uncomment this and below for timestamp
//var Moment = require('moment');

var stream = new Stream();
stream.writable = true;

var colorSet = {
  60: {
    color: 'magenta',
    name: 'Fatal:',
  },
  50: {
    color: 'red',
    name: 'Error:',
  },
  40: {
    color: 'yellow',
    name: ' Warn:',
  },
  30: {
    color: 'green',
    name: ' Info:',
  },
  20: {
    color: 'cyan',
    name: 'Debug:',
  },
  10: {
    color: 'grey',
    name: 'Trace:',
  },
};

stream.write = function(objStr) {
  var obj = JSON.parse(objStr);
  var info = '';
  var output;

  var color = colorSet[obj.level].color;
  var levelName = colorSet[obj.level].name;
  // Uncomment for timestamp
  //var time = obj.time;
  //info += Moment(time).format('hh:mm:ss');
  //info += ' ';
  info += levelName[color];
  info += ' ';

  info += obj.msg;

  output = info;

  console.log(output);
};

module.exports = stream;

